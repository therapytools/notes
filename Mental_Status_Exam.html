<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Status Exam (MSE) Tool</title>
    <!-- Tailwind CSS for modern styling and responsiveness -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Using Inter font as a modern, clean default */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom styles adapted from the original file for the MSE form */
        .mse-form-container {
            max-width: 900px;
            margin: 0 auto;
        }
        .mse-category {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .mse-category label {
            width: 100%; /* Full width on small screens */
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        /* Two columns for medium screens */
        @media (min-width: 640px) {
            .mse-category label {
                 width: 48%;
            }
        }
        /* Three columns for large screens */
        @media (min-width: 1024px) {
            .mse-category label {
                 width: 32%;
            }
        }
        .mse-category input[type="text"] {
            width: 100%;
            margin-top: 8px;
        }
        .mse-custom-input {
            width: 100%;
            padding: 8px;
            border-radius: 0.375rem;
            border: 1px solid #D1D5DB;
        }
        .mse-form-container legend {
            font-weight: 600;
            color: #4B5563; /* Darker gray for better contrast */
            font-size: 1.125em;
            margin-bottom: 0.75rem;
        }
        /* Style for the custom copy notification */
        #copy-notification {
            transition: opacity 0.5s, transform 0.5s;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Main container for the tool -->
    <div class="container mx-auto p-4 sm:p-6 md:p-8">
        <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6 md:p-8">
            <div class="mse-form-container">
                <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">Mental Status Exam</h1>

                <!-- Presets Section -->
                <fieldset class="border p-4 rounded-lg mb-6">
                    <legend>Presets</legend>
                    <div class="space-y-2">
                        <label class="flex items-center cursor-pointer">
                            <input id="positiveMSE" onclick="togglePositiveMSE()" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <span class="ml-3 text-gray-700">Normal MSE</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input id="telehealthpositiveMSE" onclick="TelehealthPositiveMSE()" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <span class="ml-3 text-gray-700">Telehealth Normal MSE</span>
                        </label>
                    </div>
                </fieldset>

                <!-- MSE Categories -->
                <div class="space-y-6">
                    <fieldset class="border p-4 rounded-lg"><legend>Orientation</legend><div class="mse-category"><label><input id="x4" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Oriented x4</label><label><input id="time" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Time</label><label><input id="place" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Place</label><label><input id="situation" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Situation</label><label><input id="person" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Person</label><input class="mse-custom-input" id="orientationCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Clothing/Grooming</legend><div class="mse-category"><label><input id="neat" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Neat</label><label><input id="clean" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Clean</label><label><input id="appropriatelydressed" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Appropriately Dressed</label><label><input id="careless" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Careless</label><label><input id="disheveled" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Disheveled</label><label><input id="dirty" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Dirty</label><label><input id="inappropriate" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Inappropriate</label><label><input id="bizarre" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Bizarre</label><input class="mse-custom-input" id="clothingGroomingCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Motor Activity</legend><div class="mse-category"><label><input id="notRemarkable" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Not Remarkable</label><label><input id="slowed" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Slowed</label><label><input id="repetitive" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Repetitive</label><label><input id="restless" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Restless</label><label><input id="agitated" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Agitated</label><label><input id="tremor" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Tremor</label><input class="mse-custom-input" id="motorActivityCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Behavior</legend><div class="mse-category"><label><input id="appropriate" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Appropriate</label><label><input id="aggressive" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Aggressive</label><label><input id="angry" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Angry</label><label><input id="apathetic" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Apathetic</label><label><input id="irritable" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Irritable</label><label><input id="passive" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Passive</label><label><input id="manipulative" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Manipulative</label><input class="mse-custom-input" id="behaviorCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Attention</legend><div class="mse-category"><label><input id="normalAttention" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Normal</label><label><input id="unaware" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Unaware</label><label><input id="distractible" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Distractible</label><label><input id="vigilant" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Vigilant</label><input class="mse-custom-input" id="attentionCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Recall/Memory</legend><div class="mse-category"><label><input id="normalMemory" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Normal</label><label><input id="shortTermImpaired" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Short-term Impaired, Long-Term Intact</label><label><input id="longTermImpaired" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Short-term Intact, Long-term Impaired</label><input class="mse-custom-input" id="recallMemoryCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Eye Contact</legend><div class="mse-category"><label><input id="normalEyeContact" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Normal</label><label><input id="fleeting" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Fleeting</label><label><input id="avoided" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Avoided</label><label><input id="none" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> None</label><label><input id="staring" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Staring</label><input class="mse-custom-input" id="eyeContactCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Facial Expression</legend><div class="mse-category"><label><input id="responsive" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Responsive</label><label><input id="tense" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Tense</label><label><input id="anxious" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Anxious</label><label><input id="sad" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Sad</label><label><input id="angry" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Angry</label><input class="mse-custom-input" id="facialExpressionCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Attitude toward Evaluator</legend><div class="mse-category"><label><input id="cooperative" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Cooperative</label><label><input id="friendly" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Friendly</label><label><input id="guarded" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Guarded</label><label><input id="hostile" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Hostile</label><label><input id="indifferent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Indifferent</label><label><input id="ingratiating" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Ingratiating</label><label><input id="manipulative" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Manipulative</label><label><input id="open" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Open</label><label><input id="seductive" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Seductive</label><label><input id="suspicious" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Suspicious</label><label><input id="uncooperative" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Uncooperative</label><input class="mse-custom-input" id="attitudeEvaluatorCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Affect</legend><div class="mse-category"><label><input id="affectCongruent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Congruent</label><label><input id="affectIncongruent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Incongruent</label><label><input id="affectAppropriate" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Appropriate</label><label><input id="affectInappropriate" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Inappropriate</label><label><input id="labile" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Labile</label><label><input id="restricted" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Restricted</label><label><input id="flat" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Flat</label><label><input id="reactive" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Reactive</label><label><input id="blunted" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Blunted</label><input class="mse-custom-input" id="affectCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Mood</legend><div class="mse-category"><label><input id="euthymic" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Euthymic</label><label><input id="dysphoric" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Dysphoric</label><label><input id="anxiousmood" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Anxious</label><label><input id="angrymood" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Angry</label><label><input id="irritableMood" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Irritable</label><label><input id="pessimistic" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Pessimistic</label><label><input id="depressed" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Depressed</label><label><input id="hypomanic" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Hypomanic</label><label><input id="euphoric" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Euphoric</label><input class="mse-custom-input" id="moodCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Speech</legend><div class="mse-category"><label><input id="normalSpeech" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Normal</label><label><input id="loud" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Loud</label><label><input id="blocked" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Blocked</label><label><input id="pressured" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Pressured</label><label><input id="flightOfIdeas" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Flight of Ideas</label><label><input id="slurred" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Slurred</label><label><input id="soft" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Soft</label><label><input id="stuttering" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Stuttering</label><label><input id="mute" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Mute</label><label><input id="verbose" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Verbose</label><input class="mse-custom-input" id="speechCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Expression of Thought Content</legend><div class="mse-category"><label><input id="expressionCongruent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Congruent</label><label><input id="expressionIncongruent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Incongruent</label><label><input id="looseassociations" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Loose Associations</label><label><input id="suspicions" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Suspicions</label><label><input id="delusions" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Delusions</label><label><input id="phobias" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Phobias</label><label><input id="obsessions" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Obsessions</label><input class="mse-custom-input" id="expressionCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Organization of Thought</legend><div class="mse-category"><label><input id="normalOrganization" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Normal</label><label><input id="logical" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Logical</label><label><input id="goalDirected" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Goal-directed</label><input class="mse-custom-input" id="organizationCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Perception</legend><div class="mse-category"><label><input id="noHallucinations" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> No Hallucinations or Delusions</label><label><input id="auditoryhallucinations" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Auditory Hallucinations</label><label><input id="visualhallucinations" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Visual Hallucinations</label><label><input id="olfactoryhallucinations" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Olfactory Hallucinations</label><label><input id="tactilehallucinations" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Tactile Hallucinations</label><label><input id="gustatoryhallucinations" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Gustatory Hallucinations</label><label><input id="delusionsPresent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Delusions Present</label><input class="mse-custom-input" id="perceptionCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Insight</legend><div class="mse-category"><label><input id="insightExcellent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Excellent</label><label><input id="insightGood" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Good</label><label><input id="insightFair" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Fair</label><label><input id="insightPoor" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Poor</label><label><input id="insightNil" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Nil</label><input class="mse-custom-input" id="insightCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Judgment</legend><div class="mse-category"><label><input id="judgementExcellent" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Excellent</label><label><input id="judgementGood" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Good</label><label><input id="judgementFair" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Fair</label><label><input id="judgementPoor" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Poor</label><label><input id="judgementNil" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Nil</label><label><input id="judgementDangerous" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Dangerous</label><input class="mse-custom-input" id="judgmentCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Decision Making</legend><div class="mse-category"><label><input id="normalDecisionMaking" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Normal</label><label><input id="onlySimple" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Only Simple</label><label><input id="impulsive" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Impulsive</label><label><input id="confused" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Confused</label><input class="mse-custom-input" id="decisionMakingCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                    <fieldset class="border p-4 rounded-lg"><legend>Safety</legend><div class="mse-category"><label><input id="noSIHI" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> No evidence or report of SI/HI</label><label><input id="deniesSIHI" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Denies SI/HI</label><label><input id="reportsHI" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Reports HI</label><label><input id="reportsPassiveSIT" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Reports Passive Suicidal Thoughts</label><label><input id="reportsSuicidePlan" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Reports Suicide Plan</label><label><input id="reportsSuicidalIntention" onclick="updateMseText()" type="checkbox" class="mr-2 h-4 w-4"> Reports Suicidal Intention</label><input class="mse-custom-input" id="safetyCustom" oninput="updateMseText()" placeholder="Other..." type="text"></div></fieldset>
                </div>

                <!-- Output Textarea and Copy Button -->
                <textarea class="w-full mt-8 p-3 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" id="mseTextbox" rows="15" placeholder="Your generated MSE report will appear here..."></textarea>
                <button class="mt-4 w-full sm:w-auto px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors" onclick="copyMseToClipboard()">
                    COPY MSE
                </button>
            </div>
        </div>
    </div>

    <!-- Floating Notification for Copy Action -->
    <div id="copy-notification" class="fixed bottom-5 right-5 bg-gray-800 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 transform translate-y-2">
        Copied to clipboard!
    </div>

    <script>
        // --- MSE (Mental Status Exam) Logic ---

        // Checkbox IDs for the "Normal MSE" preset
        const msePositiveCheckboxes = [ "noSIHI", "x4", "neat", "clean", "appropriatelydressed", "notRemarkable", "appropriate", "normalAttention", "normalMemory", "normalEyeContact", "responsive", "cooperative", "affectCongruent", "affectAppropriate", "euthymic", "normalSpeech", "expressionCongruent", "normalOrganization", "logical", "goalDirected", "noHallucinations", "insightExcellent", "judgementExcellent", "normalDecisionMaking" ];
        
        // Checkbox IDs for the "Telehealth Normal MSE" preset
        const telehealthPositiveCheckboxes = [ "noSIHI", "x4", "appropriate", "normalAttention", "normalMemory", "cooperative", "affectCongruent", "affectAppropriate", "euthymic", "normalSpeech", "expressionCongruent", "normalOrganization", "logical", "goalDirected", "noHallucinations", "insightExcellent", "judgementExcellent", "normalDecisionMaking" ];
        
        /**
         * Toggles all checkboxes for a standard "Normal MSE".
         * If this is checked, it unchecks the telehealth preset.
         */
        function togglePositiveMSE() {
            const positiveMSE = document.getElementById("positiveMSE");
            if (positiveMSE.checked) {
                document.getElementById("telehealthpositiveMSE").checked = false;
            }
            // Check or uncheck all relevant boxes based on the preset's state
            msePositiveCheckboxes.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) checkbox.checked = positiveMSE.checked;
            });
            updateMseText();
        }

        /**
         * Toggles all checkboxes for a "Telehealth Normal MSE".
         * If this is checked, it unchecks the standard preset.
         */
        function TelehealthPositiveMSE() {
            const telehealthpositiveMSE = document.getElementById("telehealthpositiveMSE");
            if (telehealthpositiveMSE.checked) {
                document.getElementById("positiveMSE").checked = false;
            }
            // Check or uncheck all relevant boxes based on the preset's state
             telehealthPositiveCheckboxes.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) checkbox.checked = telehealthpositiveMSE.checked;
            });
            updateMseText();
        }

        /**
         * Gathers all checked items and custom text to generate the MSE report.
         * This function is called whenever any input changes.
         */
        function updateMseText() {
            const mseTextbox = document.getElementById("mseTextbox");
            let text = "";

            // Defines the structure of the MSE form, mapping categories to their inputs.
            const categories = [
                { name: "Orientation", checkboxes: ["x4", "time", "place", "situation", "person"], custom: "orientationCustom" },
                { name: "Clothing/Grooming", checkboxes: ["neat", "clean", "appropriatelydressed", "careless", "disheveled", "dirty", "inappropriate", "bizarre"], custom: "clothingGroomingCustom" },
                { name: "Motor Activity", checkboxes: ["notRemarkable", "slowed", "repetitive", "restless", "agitated", "tremor"], custom: "motorActivityCustom" },
                { name: "Behavior", checkboxes: ["appropriate", "aggressive", "angry", "apathetic", "irritable", "passive", "manipulative"], custom: "behaviorCustom" },
                { name: "Attention", checkboxes: ["normalAttention", "unaware", "distractible", "vigilant"], custom: "attentionCustom" },
                { name: "Recall/Memory", checkboxes: ["normalMemory", "shortTermImpaired", "longTermImpaired"], custom: "recallMemoryCustom" },
                { name: "Eye Contact", checkboxes: ["normalEyeContact", "fleeting", "avoided", "none", "staring"], custom: "eyeContactCustom" },
                { name: "Facial Expression", checkboxes: ["responsive", "tense", "anxious", "sad", "angry"], custom: "facialExpressionCustom" },
                { name: "Attitude toward Evaluator", checkboxes: ["cooperative", "friendly", "guarded", "hostile", "indifferent", "ingratiating", "manipulative", "open", "seductive", "suspicious", "uncooperative"], custom: "attitudeEvaluatorCustom" },
                { name: "Affect", checkboxes: ["affectCongruent", "affectIncongruent", "affectAppropriate", "affectInappropriate", "labile", "restricted", "flat", "reactive", "blunted"], custom: "affectCustom" },
                { name: "Mood", checkboxes: ["euthymic", "dysphoric", "anxiousmood", "angrymood", "irritableMood", "pessimistic", "depressed", "hypomanic", "euphoric"], custom: "moodCustom" },
                { name: "Speech", checkboxes: ["normalSpeech", "loud", "blocked", "pressured", "flightOfIdeas", "slurred", "soft", "stuttering", "mute", "verbose"], custom: "speechCustom" },
                { name: "Expression of Thought Content", checkboxes: ["expressionCongruent", "expressionIncongruent", "looseassociations", "suspicions", "delusions", "phobias", "obsessions"], custom: "expressionCustom" },
                { name: "Organization of Thought", checkboxes: ["normalOrganization", "logical", "goalDirected"], custom: "organizationCustom" },
                { name: "Perception", checkboxes: ["noHallucinations", "auditoryhallucinations", "visualhallucinations", "olfactoryhallucinations", "tactilehallucinations", "gustatoryhallucinations", "delusionsPresent"], custom: "perceptionCustom" },
                { name: "Insight", checkboxes: ["insightExcellent", "insightGood", "insightFair", "insightPoor", "insightNil"], custom: "insightCustom" },
                { name: "Judgment", checkboxes: ["judgementExcellent", "judgementGood", "judgementFair", "judgementPoor", "judgementNil", "judgementDangerous"], custom: "judgmentCustom" },
                { name: "Decision Making", checkboxes: ["normalDecisionMaking", "onlySimple", "impulsive", "confused"], custom: "decisionMakingCustom" },
                { name: "Safety", checkboxes: ["noSIHI", "deniesSIHI", "reportsHI", "reportsPassiveSIT", "reportsSuicidePlan", "reportsSuicidalIntention"], custom: "safetyCustom" }
            ];

            // Loop through each category to build the report string
            categories.forEach(category => {
                const checkedItems = [];
                // Get values from checked checkboxes
                category.checkboxes.forEach(id => {
                    const checkbox = document.getElementById(id);
                    if (checkbox && checkbox.checked) {
                        // Get the label text next to the checkbox
                        checkedItems.push(checkbox.parentElement.textContent.trim());
                    }
                });
                // Get value from the custom text input
                const customInput = document.getElementById(category.custom) ? document.getElementById(category.custom).value.trim() : "";
                if (customInput) {
                    checkedItems.push(customInput);
                }
                // If any items were selected for the category, add it to the report
                if (checkedItems.length > 0) {
                    text += `${category.name}: ${checkedItems.join(", ")}\n`;
                }
            });

            // Update the main textarea with the generated text
            mseTextbox.value = text.trim();
        }

        /**
         * Copies the content of the MSE textarea to the clipboard and shows a notification.
         */
        function copyMseToClipboard() {
            const textbox = document.getElementById("mseTextbox");
            if (!textbox.value) return; // Don't copy if empty

            textbox.select();
            // Use the modern Clipboard API if available, with a fallback
            if (navigator.clipboard) {
                navigator.clipboard.writeText(textbox.value).then(() => {
                    showCopyNotification();
                });
            } else {
                try {
                    document.execCommand("copy");
                    showCopyNotification();
                } catch (err) {
                    console.error('Fallback copy failed', err);
                }
            }
        }

        /**
         * Displays a brief "Copied!" notification.
         */
        function showCopyNotification() {
            const notification = document.getElementById('copy-notification');
            notification.style.opacity = '1';
            notification.style.transform = 'translateY(0)';
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(0.5rem)';
            }, 2000); // Notification visible for 2 seconds
        }

        // Initial call to populate the textarea if any checkboxes are checked on load
        document.addEventListener('DOMContentLoaded', updateMseText);
    </script>
</body>
</html>
